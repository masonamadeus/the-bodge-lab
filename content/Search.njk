---
permalink: /Search/
layout: layout.njk
title: "Search The Bodgelab"
eleventyExcludeFromCollections: true
directory: true 
download: false 
---

<h2>Search the BodgeLab</h2>
<p>Search for pages by title or URL. Results will appear as you type.</p>

{# 1. The HTML for the search box and results #}
<style>
  #search-box {
    width: 100%;
    padding: 0.5em;
    font-size: 1.2em;
    margin-bottom: 1em;
    border-radius: 0;
    border: 1px solid var(--border-color);
  }
  #search-results ul {
    list-style: none;
    padding-left: 0;
  }
  #search-results li {
    margin-bottom: 1em;
    border-bottom: 1px dashed var(--text-muted);
    padding-bottom: 1em;
  }
  #search-results small {
    color: var(--text-muted);
  }
</style>

<input type="search" id="search-box" placeholder="Start typing to search..." autofocus>

<div id="search-results">
  <p><i>Waiting you to start typing...</i></p>
</div>

<script>
  // --- ADD THIS LISTENER WRAPPER ---
  document.addEventListener('bodgelab:searchready', () => {

    // 1. Get the elements
    const searchInput = document.getElementById('search-box');
    const resultsContainer = document.getElementById('search-results');
    
    let allPages = null; // We'll lazy-load this

    // 2. Add the event listener
    searchInput.addEventListener('input', async () => {
      
      // 3. (NEW) Fetch data on first input, if we haven't already
      if (!allPages) {
        resultsContainer.innerHTML = '<p><i>Loading search data...</i></p>';
        allPages = await window.BodgeLab.getSearchData();
      }

      // 4. Run the search and render
      const query = searchInput.value;
      const results = window.BodgeLab.runSearch(query, allPages);
      window.BodgeLab.renderResults(results, resultsContainer, query);
    });

  // --- AND CLOSE IT HERE ---
  });
</script>