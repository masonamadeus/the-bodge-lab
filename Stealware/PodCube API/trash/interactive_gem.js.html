<!DOCTYPE html>
<html lang="en">
    <head>
        
        <script>
            (function () {
                const STORAGE_KEY = 'bodge-id-v1';
                const SIZE = 5;
                // 1. Try to load existing identity
                let identity = null;
                try {
                    identity = JSON.parse(localStorage.getItem(STORAGE_KEY));
                } catch (e) {}
                // 2. If no identity, GENESIS MODE (Random Generation)
                if (! identity) {
                    const hue = Math.floor(Math.random() * 360);
                    const grid = new Array(SIZE * SIZE).fill(null);
                    // Generate Mirrored Pattern
                    for (let x = 0; x < Math.ceil(SIZE / 2); x++) {
                        for (let y = 0; y < SIZE; y++) {
                            if (Math.random() > 0.5) {
                                const alpha = (Math.random() * 0.6 + 0.4).toFixed(2);
                                // We store: { o: opacity, c: customColor (optional) }
                                const pixel = {
                                    o: alpha
                                };
                                // Set Left
                                grid[y * SIZE + x] = pixel;
                                // Set Mirror
                                if (x < Math.floor(SIZE / 2)) {
                                    grid[y * SIZE + (SIZE - 1 - x)] = pixel;
                                }
                            }
                        }
                    }
                    identity = {
                        hue,
                        grid
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(identity));
                }
                // 3. Render SVG Define Theme Colors based on the stored Hue
                const cLight = `hsl(${
                    identity.hue
                }, 80%, 40%)`;
                const cDark = `hsl(${
                    identity.hue
                }, 80%, 70%)`;
                let rects = '';
                identity.grid.forEach((pixel, i) => {
                    if (!pixel) 
                        return;
                    
                    const x = i % SIZE;
                    const y = Math.floor(i / SIZE);
                    // If pixel has a custom color, use it. Otherwise use CSS var. We use a CSS class 'themable' to let the style block
                    // handle standard pixels
                    const fillAttr = pixel.c
                        ? `fill="${
                        pixel.c
                    }"` : `class="themable"`;
                    rects += `<rect x="${x}" y="${y}" width="1" height="1" opacity="${
                        pixel.o
                    }" ${fillAttr} />`;
                });
                const svg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${SIZE} ${SIZE}" shape-rendering="crispEdges">
            <style>
                .themable { fill: ${cLight}; }
                @media (prefers-color-scheme: dark) {
                    .themable { fill: ${cDark}; } 
                }
                /* Custom text color checks */
                text { fill: black; font-weight: 900; pointer-events: none; }
                @media (prefers-color-scheme: dark) { text { fill: white; } }
            </style>
            ${rects}
            <text x="2.5" y="3.5" text-anchor="middle" font-family="monospace" font-size="3px"></text>
            </svg>`;
                const link = document.createElement('link');
                link.rel = 'icon';
                link.id = 'dynamic-favicon'; // ID for easier updates later
                link.href = 'data:image/svg+xml,' + encodeURIComponent(svg);
                document.head.appendChild(link);
                // Expose for the editor to use
                window.BodgeIdentity = {
                    data: identity,
                    save: (newData) => {
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(newData));
                    }
                };
            })();
        </script>
        <link rel="stylesheet" href="/css/main.css">
        <script src="/js/theme.js"></script>
        <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <meta charset="UTF-8">
        <title>interactive_gem.js</title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="generator" content="Eleventy v3.1.2">
        <meta name="description" content="A curious folder on the internet. Home of Mason Amadeus">
        <link
        rel="canonical" href="https://bodgelab.com/%7B%7B%20media.url%20|%20safe%20%7D%7D.html"> 
        <meta property="og:site_name" content="The Bodge Lab">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://bodgelab.com/%7B%7B%20media.url%20|%20safe%20%7D%7D.html">
        <meta property="og:title" content="interactive_gem.js">
        <meta
        property="og:description" content="A curious folder on the internet. Home of Mason Amadeus"> 
        <meta property="og:image" content="https://bodgelab.com/.config/ogimg.jpg">
        <meta
        name="twitter:image" content="https://bodgelab.com/.config/ogimg.jpg">
        
        
            
            <meta name="twitter:card" content="summary_large_image">
        
    </head>
    <body>
        <svg id="paperfilter">
            <defs>
                <filter id="paperlike" x="-20%" y="-20%" width="140%" height="140%" type="fractalNoise">
                    <feTurbulence basefrequency="0.0005" numoctaves="1" result="noise"/>
                    <feDisplacementMap in="SourceGraphic" in2="noise" scale="1" xchannelselector="R" ychannelselector="R"></filter>
                </defs>
            </svg>
            <header class="sticky">
                <nav class="nav-container">
                    <div class="breadcrumb-nav">
                        <div class="breadcrumb-mover">
                            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Theme">
                                <svg
                                    viewbox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="theme-icon">
                                    <path id="sun-icon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                    <g id="moon-icon">
                                        <path d="M12 2a7 7 0 0 0-7 7c0 2.32 1.04 4.39 2.66 5.82a2 2 0 0 1 .68 1.48V19a2 2 0 0 0 2 2h3.32a2 2 0 0 0 2-2v-2.7a2 2 0 0 1
                                            .68-1.48C17.96 13.39 19 11.32 19 9a7 7 0 0 0-7-7Z"></path>
                                        <path d="M9 21h6"></path>
                                        <path d="M9 17h6"></path>
                                    </g>
                                </svg>
                            </button>
                            <span class="separator">\\</span>
                            <a href="/" class="breadcrumb" title="Home Directory">BodgeLab</a>
                            
                            
                            
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <a href="/Stealware/" class="breadcrumb">Stealware</a>
                                    
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <a href="/Stealware/PodCube API/" class="breadcrumb">PodCube API</a>
                                    
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <a href="/Stealware/PodCube API/trash/" class="breadcrumb">trash</a>
                                    
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <span class="current">interactive_gem.js</span>
                                    
                                
                            
                        </div>
                    </div>
                    <div
                        class="page-nav">
                        
                        
                            <div>
                                <a href="/Stealware/PodCube API/trash/" class="nav-link up">⇱ Go Up</a>
                            </div>
                        
                        
                        
                            <div class="page-meta-date">
                                <i>
                                    <em>Modified: February 28, 2026</em>
                                </i>
                            </div>
                        
                    </div>
                </nav>
            </header>
            
                <main class="main-content">
                    
  <h2>interactive_gem.js</h2>
  
  
  
    <div class="media-embed-wrapper text-embed">
                      <pre class="language-js"><code class="language-js">//
// =============================================================================
// Interactive Engine v3.7
// =============================================================================
//
// A lightweight, class-based game engine designed for &quot;cartridge&quot; style games.
// It handles the game loop, input normalization (mouse/touch/keyboard),
// HTML5 Canvas rendering, and a DOM-based UI overlay system.
//
// DESIGN GOALS:
// - Deterministic, fixed-resolution logic (400x300)
// - Minimal abstractions, readable control flow
// - Cartridge isolation (fresh state per run)
// - Declarative DOM UI layered over a canvas renderer
//
// =============================================================================
&#039;use strict&#039;;

/**
 * =============================================================================
 * GLOBAL UTILITY BELT (window.PC)
 * =============================================================================
 */
window.PC = {
    /** Linear interpolation between a and b */
    lerp: (a, b, t) =&gt; a + (b - a) * t,

    /** Clamp value between lo and hi */
    clamp: (v, lo, hi) =&gt; Math.max(lo, Math.min(hi, v)),

    /** Random float in [lo, hi) */
    rand: (lo, hi) =&gt; Math.random() * (hi - lo) + lo,

    /** Random integer in [lo, hi] */
    randInt: (lo, hi) =&gt; Math.floor(Math.random() * (hi - lo + 1)) + lo,

    /** Euclidean distance between points */
    dist: (a, b) =&gt; Math.hypot(b.x - a.x, b.y - a.y),

    /**
     * Axis-Aligned Bounding Box collision test
     * @param {{x:number,y:number,w:number,h:number}} a
     * @param {{x:number,y:number,w:number,h:number}} b
     */
    hitRect: (a, b) =&gt;
        a.x &lt; b.x + b.w &amp;&amp;
        a.x + a.w &gt; b.x &amp;&amp;
        a.y &lt; b.y + b.h &amp;&amp;
        a.y + a.h &gt; b.y,

    /**
     * Creates a fixed-interval accumulator timer.
     * Immune to drift caused by variable frame times.
     * @param {number} interval - Seconds between ticks
     * @returns {{max:number, t:number, tick:(dt:number)=&gt;boolean}}
     */
    makeTimer: (interval) =&gt; ({
        max: interval,
        t: 0,
        tick(dt) {
            this.t += dt;
            if (this.t &gt;= this.max) {
                this.t %= this.max;
                return true;
            }
            return false;
        }
    }),
};

/**
 * =============================================================================
 * ENTITY BASE CLASS
 * =============================================================================
 */
class Entity {
    constructor(x = 0, y = 0) {
        this.x = x;
        this.y = y;
        this.dead = false; // Flagged for GC at end of frame
        this.z = 0;        // Draw order (ascending)
    }

    /**
     * Per-frame logic update
     * @param {number} dt - Delta time (seconds)
     * @param {Object} input - Input state
     * @param {Game} game - Reference to game instance
     */
    update(dt, input, game) {}

    /**
     * Per-frame render hook
     * @param {Object} gfx - Graphics helper
     */
    draw(gfx) {}

    /** Marks entity for destruction */
    destroy() { this.dead = true; }
}

/**
 * =============================================================================
 * GAME BASE CLASS (CARTRIDGE)
 * =============================================================================
 */
class Game {
    constructor(api) {
        this.api = api;
        this.entities = [];
        this.score = 0;
        this.meta = { title: &quot;Untitled&quot;, desc: &quot;&quot;, instructions: &quot;&quot; };
    }

    onInit() {}
    onCleanup() {}

    /** Adds entity and maintains Z-order invariant */
    add(entity) {
        this.entities.push(entity);
        this.entities.sort((a, b) =&gt; a.z - b.z);
        return entity;
    }

    /** Finds first entity of given class */
    find(Type) {
        return this.entities.find(e =&gt; e instanceof Type);
    }

    /** Returns all entities of given class overlapping the source */
    collideAll(entity, Type) {
        if (entity.w === undefined || entity.h === undefined) return [];
        return this.entities.filter(other =&gt; 
            other !== entity &amp;&amp; 
            !other.dead &amp;&amp; 
            (other.w !== undefined &amp;&amp; other.h !== undefined) &amp;&amp;
            (!Type || other instanceof Type) &amp;&amp;
            window.PC.hitRect(entity, other)
        );
    }

    update(dt, input) {
        for (const e of this.entities) {
            if (!e.dead) e.update(dt, input, this);
        }
        this.entities = this.entities.filter(e =&gt; !e.dead);
    }

    draw(gfx) {
        for (const e of this.entities) e.draw(gfx);
    }
}

/**
 * =============================================================================
 * PHYSICS MODULE
 * =============================================================================
 */
const Physics = {
    // 2D Grid for environmental collision
    World: class {
        constructor(cols, rows, tileSize) {
            this.cols = cols;
            this.rows = rows;
            this.size = tileSize;
            this.data = new Uint8Array(cols * rows).fill(0);
        }

        get(x, y) {
            if (x &lt; 0 || x &gt;= this.cols || y &lt; 0 || y &gt;= this.rows) return 1;
            return this.data[y * this.cols + x];
        }

        set(x, y, val) {
            if (x &gt;= 0 &amp;&amp; x &lt; this.cols &amp;&amp; y &gt;= 0 &amp;&amp; y &lt; this.rows) {
                this.data[y * this.cols + x] = val;
            }
        }

        toGrid(px) { return Math.floor(px / this.size); }
        
        // Check if any tile within the rectangular bounds is solid (&gt;0)
        overlap(x, y, w, h) {
            const l = this.toGrid(x);
            const r = this.toGrid(x + w - 0.1);
            const t = this.toGrid(y);
            const b = this.toGrid(y + h - 0.1);
            
            for (let gy = t; gy &lt;= b; gy++) {
                for (let gx = l; gx &lt;= r; gx++) {
                    if (this.get(gx, gy) &gt; 0) return true;
                }
            }
            return false;
        }
    },

    // A generic physical body with AABB collision and sub-pixel movement
    Actor: class extends Entity {
        constructor(x, y, w, h) {
            super(x, y);
            this.w = w; this.h = h;
            this.vx = 0; this.vy = 0;
            this.grounded = false;
            this.remainderX = 0; 
            this.remainderY = 0;
        }

        /**
         * Integrates velocity into position, resolving collisions against the World.
         * Sets this.grounded = true if standing on a solid.
         * Zeros out velocity upon collision.
         */
        updatePhysics(dt, world, gravity = 800) {
            this.vy += gravity * dt;

            // X Movement
            this.remainderX += this.vx * dt;
            let moveX = Math.round(this.remainderX);
            if (moveX !== 0) {
                this.remainderX -= moveX;
                const sign = Math.sign(moveX);
                // Step pixel-by-pixel
                while (moveX !== 0) {
                    if (!world.overlap(this.x + sign, this.y, this.w, this.h)) {
                        this.x += sign;
                        moveX -= sign;
                    } else {
                        // HIT WALL
                        this.vx = 0;
                        break;
                    }
                }
            }

            // Y Movement
            this.remainderY += this.vy * dt;
            let moveY = Math.round(this.remainderY);
            if (moveY !== 0) {
                this.remainderY -= moveY;
                const sign = Math.sign(moveY);
                while (moveY !== 0) {
                    if (!world.overlap(this.x, this.y + sign, this.w, this.h)) {
                        this.y += sign;
                        moveY -= sign;
                        this.grounded = false;
                    } else {
                        // HIT CEILING OR FLOOR
                        if (sign &gt; 0) this.grounded = true;
                        this.vy = 0;
                        break;
                    }
                }
            }
        }
    }
};

/**
 * =============================================================================
 * INTERACTIVE ENGINE CORE
 * =============================================================================
 */
window.Interactive = (() =&gt; {
    const W = 400; 
    const H = 300;

    let _activeGame = null;
    let _activeId = null;
    let _registry = {};
    let _canvas, _ctx, _domLayer, _loopId, _lastTime = 0;
    let _inputLocked = false;

    let _inputPending = { pressed: {}, clicked: false, sx: 0, sy: 0 };
    const input = { 
        pressed: {}, held: {}, mouse: { x: 0, y: 0, down: false, clicked: false }, _sx: 0, _sy: 0 
    };

    const KEY_MAP = { 
        &#039;ArrowUp&#039;:&#039;UP&#039;, &#039;w&#039;:&#039;UP&#039;, &#039;W&#039;:&#039;UP&#039;, 
        &#039;ArrowDown&#039;:&#039;DOWN&#039;, &#039;s&#039;:&#039;DOWN&#039;, &#039;S&#039;:&#039;DOWN&#039;, 
        &#039;ArrowLeft&#039;:&#039;LEFT&#039;, &#039;a&#039;:&#039;LEFT&#039;, &#039;A&#039;:&#039;LEFT&#039;, 
        &#039;ArrowRight&#039;:&#039;RIGHT&#039;, &#039;d&#039;:&#039;RIGHT&#039;, &#039;D&#039;:&#039;RIGHT&#039;, 
        &#039; &#039;:&#039;ACTION&#039;, &#039;Enter&#039;:&#039;ACTION&#039;, &#039;Escape&#039;:&#039;CANCEL&#039; 
    };

    // ── GFX Module ───────────────────────────────────────────────────────────
    const GFX = {
        get W() { return W; }, 
        get H() { return H; },
        clear(c=&#039;#111&#039;) { _ctx.fillStyle=c; _ctx.fillRect(0,0,W,H); },
        line(x1, y1, x2, y2, c=&#039;#fff&#039;, w=1) {
            _ctx.beginPath(); _ctx.moveTo(x1, y1); _ctx.lineTo(x2, y2);
            _ctx.strokeStyle = c; _ctx.lineWidth = w; _ctx.stroke();
        },
        rect(x,y,w,h,f) { _ctx.fillStyle=f; _ctx.fillRect(x,y,w,h); },
        circle(x,y,r,f) { _ctx.beginPath(); _ctx.arc(x,y,r,0,Math.PI*2); _ctx.fillStyle=f; _ctx.fill(); },
        text(str,x,y,opts={}) { 
            _ctx.font = `${opts.bold?&#039;bold &#039;:&#039;&#039;}${opts.size||14}px &#039;Fustat&#039;`; 
            _ctx.fillStyle = opts.color||&#039;#fff&#039;; 
            _ctx.textAlign = opts.align||&#039;left&#039;; 
            _ctx.fillText(str,x,y); 
        },
        ctx: () =&gt; _ctx 
    };

    // ── UI Module ────────────────────────────────────────────────────────────
    const UI = {
        clear() { _domLayer.innerHTML = &#039;&#039;; },
        get(id) { return document.getElementById(id); },
        build(components) {
            UI.clear();
            const container = document.createElement(&#039;div&#039;);
            container.className = &#039;pc-ui-col&#039;;
            components.forEach(def =&gt; container.appendChild(UI._make(def)));
            _domLayer.appendChild(container);
        },
        _make(def) {
            if (def.type === &#039;spacer&#039;) { 
                const d = document.createElement(&#039;div&#039;); d.style.height = (def.size || 10) + &#039;px&#039;; return d; 
            }
            const tag = (def.type === &#039;button&#039;) ? &#039;button&#039; : &#039;div&#039;;
            const el = document.createElement(tag);
            if (def.id) el.id = def.id;
            
            if (def.type === &#039;title&#039;) el.className = &#039;pc-text-title&#039;;
            if (def.type === &#039;text&#039;)  el.className = &#039;pc-text-body&#039;;
            
            if (def.type === &#039;button&#039;) {
                el.className = `pc-btn ${def.primary ? &#039;primary&#039; : &#039;&#039;}`;
                el.onclick = (e) =&gt; { 
                    if (!_inputLocked &amp;&amp; def.onClick) def.onClick(e); 
                    e.stopPropagation(); 
                };
            }
            
            if (def.type === &#039;grid&#039;) {
                el.className = &#039;pc-grid&#039;; 
                el.style.gridTemplateColumns = `repeat(${def.cols || 2}, 1fr)`;
                el.style.gap = (def.gap || 8) + &#039;px&#039;;
                (def.children || []).forEach(c =&gt; el.appendChild(UI._make(c)));
                return el;
            }

            if (def.text) el.textContent = def.text;
            if (def.style) Object.assign(el.style, def.style);
            return el;
        }
    };

    // ── Public API ───────────────────────────────────────────────────────────
    const API = {
        register(GameClass) {
            if (!GameClass.meta) return;
            const id = GameClass.meta.id;
            _registry[id] = GameClass;
            API._renderCard(GameClass);
        },

        load(id) {
            if (!_registry[id]) return;
            _activeId = id;
            document.getElementById(&#039;pc-menu-view&#039;).style.display = &#039;none&#039;;
            document.getElementById(&#039;pc-machine-view&#039;).style.display = &#039;block&#039;;
            _handleResize();
            const m = _registry[id].meta;
            API._overlay(m.title, m.instructions, &#039;START&#039;, () =&gt; API.start());
        },

        start() {
            API._hideOverlay(); 
            UI.clear();
            if (_activeGame &amp;&amp; _activeGame.onCleanup) _activeGame.onCleanup();
            
            _activeGame = new _registry[_activeId](API.gameOps);
            input.pressed = {}; input.held = {}; input.mouse.down = false; 
            _inputLocked = true; setTimeout(() =&gt; _inputLocked = false, 200);

            if (_activeGame.onInit) _activeGame.onInit();
            
            _lastTime = performance.now(); 
            _loopId = requestAnimationFrame(_tick);
        },

        eject() {
            cancelAnimationFrame(_loopId);
            if (_activeGame &amp;&amp; _activeGame.onCleanup) _activeGame.onCleanup();
            _activeGame = null; _activeId = null; 
            UI.clear();
            document.getElementById(&#039;pc-machine-view&#039;).style.display = &#039;none&#039;;
            document.getElementById(&#039;pc-menu-view&#039;).style.display = &#039;grid&#039;;
        },

        gameOps: {
            W, H, UI,
            setScore(s) { 
                document.getElementById(&#039;pc-hud-score&#039;).textContent = s; 
                if(_activeId) {
                    const k = `pc_hi_${_activeId}`;
                    const best = Math.max(s, parseInt(localStorage.getItem(k)||&#039;0&#039;));
                    localStorage.setItem(k, best);
                }
            },
            getHighScore() { return parseInt(localStorage.getItem(`pc_hi_${_activeId}`)||&#039;0&#039;); },
            saveData(k, v) { localStorage.setItem(`pc_data_${_activeId}_${k}`, JSON.stringify(v)); },
            getData(k) { const d = localStorage.getItem(`pc_data_${_activeId}_${k}`); return d ? JSON.parse(d) : null; },
            pointInEntity(px, py, e, pad = 0) {
                return px &gt;= e.x - pad &amp;&amp; px &lt;= e.x + e.w + pad &amp;&amp; py &gt;= e.y - pad &amp;&amp; py &lt;= e.y + e.h + pad;
            },
            setStatus(s) { document.getElementById(&#039;pc-hud-status&#039;).textContent = s; },
            setLabel(s) { const el = document.getElementById(&#039;pc-hud-aux&#039;); el.textContent = s; el.style.display = s ? &#039;block&#039; : &#039;none&#039;; },
            gameOver(msg) { cancelAnimationFrame(_loopId); API._overlay(msg, &#039;Terminated&#039;, &#039;RESET&#039;, () =&gt; API.start()); },
            newStage(t, d, b, cb) { 
                cancelAnimationFrame(_loopId); 
                API._overlay(t, d, b, () =&gt; { 
                    API._hideOverlay(); 
                    if(cb) cb(); 
                    _lastTime = performance.now(); 
                    _loopId = requestAnimationFrame(_tick); 
                }); 
            }
        },

        _overlay(t, d, b, fn) {
            document.getElementById(&#039;pc-overlay&#039;).classList.remove(&#039;hidden&#039;);
            document.getElementById(&#039;pc-overlay-msg&#039;).textContent = t;
            document.getElementById(&#039;pc-overlay-desc&#039;).textContent = d;
            const btn = document.getElementById(&#039;pc-overlay-btn&#039;);
            btn.textContent = b;
            btn.onclick = fn;
        },

        _hideOverlay() { document.getElementById(&#039;pc-overlay&#039;).classList.add(&#039;hidden&#039;); },

        _renderCard(Class) {
            const slot = document.getElementById(&#039;pc-cartridge-slot&#039;);
            if (!slot) return;
            const meta = Class.meta;
            const best = localStorage.getItem(`pc_hi_${meta.id}`) || &#039;—&#039;;
            const card = document.createElement(&#039;div&#039;);
            card.className = &#039;game-card&#039;;
            card.onclick = () =&gt; API.load(meta.id);
            card.innerHTML = `&lt;div class=&quot;game-card-meta&quot;&gt;MODULE: ${meta.id.toUpperCase()}&lt;/div&gt;&lt;div class=&quot;game-card-title&quot;&gt;${meta.title}&lt;/div&gt;&lt;div style=&quot;font-size:11px;color:#666;&quot;&gt;${meta.desc}&lt;/div&gt;&lt;div class=&quot;game-card-score&quot;&gt;RECORD: ${best}&lt;/div&gt;`;
            slot.appendChild(card);
        }
    };

    function _tick(now) {
        if (!_activeGame) return;
        const dt = Math.min((now - _lastTime) / 1000, 0.1);
        _lastTime = now;
        input.pressed = { ..._inputPending.pressed };
        input.mouse.clicked = _inputPending.clicked;
        _inputPending.pressed = {}; _inputPending.clicked = false;
        _activeGame.update(dt, input);
        _activeGame.draw(GFX);
        if (_loopId !== null) _loopId = requestAnimationFrame(_tick);
    }

    function _handleResize() {
        const b = document.querySelector(&#039;.pc-game-board&#039;);
        const d = document.getElementById(&#039;pc-dom-layer&#039;);
        if (b &amp;&amp; d) d.style.transform = `scale(${b.clientWidth / W})`;
    }

    async function init() {
        _canvas = document.getElementById(&#039;pc-canvas&#039;); _ctx = _canvas.getContext(&#039;2d&#039;);
        _canvas.width = W; _canvas.height = H; _domLayer = document.getElementById(&#039;pc-dom-layer&#039;);
        
        window.addEventListener(&#039;keydown&#039;, e =&gt; { if (KEY_MAP[e.key] &amp;&amp; !_inputLocked) { e.preventDefault(); _inputPending.pressed[KEY_MAP[e.key]] = true; input.held[KEY_MAP[e.key]] = true; } });
        window.addEventListener(&#039;keyup&#039;, e =&gt; { if (KEY_MAP[e.key]) input.held[KEY_MAP[e.key]] = false; });
        
        const b = document.querySelector(&#039;.pc-game-board&#039;);
        const u = e =&gt; { const r = _canvas.getBoundingClientRect(); input.mouse.x = (e.clientX - r.left) * (W / r.width); input.mouse.y = (e.clientY - r.top) * (H / r.height); };
        b.addEventListener(&#039;pointerdown&#039;, e =&gt; { if (!_inputLocked &amp;&amp; !e.target.closest(&#039;button&#039;)) { b.setPointerCapture(e.pointerId); input.mouse.down = true; input._sx = e.clientX; input._sy = e.clientY; u(e); } });
        b.addEventListener(&#039;pointermove&#039;, e =&gt; { if (input.mouse.down) e.preventDefault(); u(e); });
        b.addEventListener(&#039;pointerup&#039;, e =&gt; { if (!_inputLocked) { input.mouse.down = false; _inputPending.clicked = true; u(e); } });

        window.addEventListener(&#039;resize&#039;, _handleResize); _handleResize();
        window.Game = Game; window.Entity = Entity;
        
        try {
            const games = await (await fetch(&#039;./interactive/games/active-games.json&#039;)).json();
            games.forEach(id =&gt; { const s = document.createElement(&#039;script&#039;); s.src = `./interactive/games/${id}.js`; document.body.appendChild(s); });
        } catch (e) { console.error(e); }
    }

    return { init, register: API.register, eject: API.eject, gameOps: API.gameOps };
})();</code></pre>
                      <p class="download-btn-container">
                        <a href="/Stealware/PodCube%20API/trash/interactive_gem.js" class="page-download-btn" download>DOWNLOAD "interactive_gem.js" ⤓</a>
                      </p>
                    </div>
  
  


                    
                    
                    
                    <div id="dir-sentinel" style="display: block; width: 100%; visibility: hidden; pointer-events: none;"></div>
                </main>
            
            
                
                
                
                
                
                    <section class="directory-container">
                        <div class="directory-header">
                            
                                <a href="/Stealware/PodCube API/" class="nav-link-small up">...</a><span class="nav-link-small up" style="color: var(--border-color)">\</span>
                            
                            
                            
                            <h3 class="directory-title">
                                trash
                            </h3>
                        </div>
                        
                        
                            <ul class="dir-listing">

                                


                                
                                
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/datastream.js.html">datastream.js</a>
                                        <a href="/Stealware/PodCube API/trash/datastream.js" download class="dir-download-icon" title="Download datastream.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/interactive_gem.js.html">interactive_gem.js</a>
                                        <a href="/Stealware/PodCube API/trash/interactive_gem.js" download class="dir-download-icon" title="Download interactive_gem.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/interactive_old.js.html">interactive_old.js</a>
                                        <a href="/Stealware/PodCube API/trash/interactive_old.js" download class="dir-download-icon" title="Download interactive_old.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/lemmings.js.html">lemmings.js</a>
                                        <a href="/Stealware/PodCube API/trash/lemmings.js" download class="dir-download-icon" title="Download lemmings.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/old_snake.js.html">old_snake.js</a>
                                        <a href="/Stealware/PodCube API/trash/old_snake.js" download class="dir-download-icon" title="Download old_snake.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/quiz_old.js.html">quiz_old.js</a>
                                        <a href="/Stealware/PodCube API/trash/quiz_old.js" download class="dir-download-icon" title="Download quiz_old.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/snake_old.js.html">snake_old.js</a>
                                        <a href="/Stealware/PodCube API/trash/snake_old.js" download class="dir-download-icon" title="Download snake_old.js"></a>
                                    </li>
                                
                                    <li>
                                        <span class="icon" style="-webkit-mask-image: url('/.config/fileicon.svg'); mask-image: url('/.config/fileicon.svg');"></span>
                                        <a class="nowrap" href="/Stealware/PodCube API/trash/systemrestore.js.html">systemrestore.js</a>
                                        <a href="/Stealware/PodCube API/trash/systemrestore.js" download class="dir-download-icon" title="Download systemrestore.js"></a>
                                    </li>
                                
                            </ul>
                        
                    </section>
                
            
            
        <script src="/js/main.js"></script>
    </body>
</body></html>