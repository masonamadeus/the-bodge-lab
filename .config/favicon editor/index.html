<!DOCTYPE html>
<html lang="en">
    <head>
        
        <script>
            (function () {
                const STORAGE_KEY = 'bodge-id-v1';
                const SIZE = 5;
                // 1. Try to load existing identity
                let identity = null;
                try {
                    identity = JSON.parse(localStorage.getItem(STORAGE_KEY));
                } catch (e) {}
                // 2. If no identity, GENESIS MODE (Random Generation)
                if (! identity) {
                    const hue = Math.floor(Math.random() * 360);
                    const grid = new Array(SIZE * SIZE).fill(null);
                    // Generate Mirrored Pattern
                    for (let x = 0; x < Math.ceil(SIZE / 2); x++) {
                        for (let y = 0; y < SIZE; y++) {
                            if (Math.random() > 0.5) {
                                const alpha = (Math.random() * 0.6 + 0.4).toFixed(2);
                                // We store: { o: opacity, c: customColor (optional) }
                                const pixel = {
                                    o: alpha
                                };
                                // Set Left
                                grid[y * SIZE + x] = pixel;
                                // Set Mirror
                                if (x < Math.floor(SIZE / 2)) {
                                    grid[y * SIZE + (SIZE - 1 - x)] = pixel;
                                }
                            }
                        }
                    }
                    identity = {
                        hue,
                        grid
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(identity));
                }
                // 3. Render SVG Define Theme Colors based on the stored Hue
                const cLight = `hsl(${
                    identity.hue
                }, 80%, 40%)`;
                const cDark = `hsl(${
                    identity.hue
                }, 80%, 70%)`;
                let rects = '';
                identity.grid.forEach((pixel, i) => {
                    if (!pixel) 
                        return;
                    
                    const x = i % SIZE;
                    const y = Math.floor(i / SIZE);
                    // If pixel has a custom color, use it. Otherwise use CSS var. We use a CSS class 'themable' to let the style block
                    // handle standard pixels
                    const fillAttr = pixel.c
                        ? `fill="${
                        pixel.c
                    }"` : `class="themable"`;
                    rects += `<rect x="${x}" y="${y}" width="1" height="1" opacity="${
                        pixel.o
                    }" ${fillAttr} />`;
                });
                const svg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${SIZE} ${SIZE}" shape-rendering="crispEdges">
            <style>
                .themable { fill: ${cLight}; }
                @media (prefers-color-scheme: dark) {
                    .themable { fill: ${cDark}; } 
                }
                /* Custom text color checks */
                text { fill: black; font-weight: 900; pointer-events: none; }
                @media (prefers-color-scheme: dark) { text { fill: white; } }
            </style>
            ${rects}
            <text x="2.5" y="3.5" text-anchor="middle" font-family="monospace" font-size="3px"></text>
            </svg>`;
                const link = document.createElement('link');
                link.rel = 'icon';
                link.id = 'dynamic-favicon'; // ID for easier updates later
                link.href = 'data:image/svg+xml,' + encodeURIComponent(svg);
                document.head.appendChild(link);
                // Expose for the editor to use
                window.BodgeIdentity = {
                    data: identity,
                    save: (newData) => {
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(newData));
                    }
                };
            })();
        </script>
        <link rel="stylesheet" href="/css/main.css">
        <script src="/js/theme.js"></script>
        <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <meta charset="UTF-8">
        <title>Favicon Editor</title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="generator" content="Eleventy v3.1.2">
        <meta name="description" content="Edit Your Favicon Click pixels to paint. Right-click to erase. /* Editor Styles */
.editor-ui {
    background: var(--bg-muted);
    padding: 2em;
    bord...">
        <link
        rel="canonical" href="https://bodgelab.com/.config/favicon%20editor/"> 
        <meta property="og:site_name" content="The Bodge Lab">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://bodgelab.com/.config/favicon%20editor/">
        <meta property="og:title" content="Favicon Editor">
        <meta
        property="og:description" content="Edit Your Favicon Click pixels to paint. Right-click to erase. /* Editor Styles */
.editor-ui {
    background: var(--bg-muted);
    padding: 2em;
    bord..."> 
        <meta property="og:image" content="https://bodgelab.com/.config/ogimg.jpg">
        <meta
        name="twitter:image" content="https://bodgelab.com/.config/ogimg.jpg">
        
        
            
            <meta name="twitter:card" content="summary_large_image">
        
    </head>
    <body>
        <svg id="paperfilter">
            <defs>
                <filter id="paperlike" x="-20%" y="-20%" width="140%" height="140%" type="fractalNoise">
                    <feTurbulence basefrequency="0.0005" numoctaves="1" result="noise"/>
                    <feDisplacementMap in="SourceGraphic" in2="noise" scale="1" xchannelselector="R" ychannelselector="R"></filter>
                </defs>
            </svg>
            <header class="sticky">
                <nav class="nav-container">
                    <div class="breadcrumb-nav">
                        <div class="breadcrumb-mover">
                            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Theme">
                                <svg
                                    viewbox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    class="theme-icon">
                                    <path id="sun-icon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                    <g id="moon-icon">
                                        <path d="M12 2a7 7 0 0 0-7 7c0 2.32 1.04 4.39 2.66 5.82a2 2 0 0 1 .68 1.48V19a2 2 0 0 0 2 2h3.32a2 2 0 0 0 2-2v-2.7a2 2 0 0 1
                                            .68-1.48C17.96 13.39 19 11.32 19 9a7 7 0 0 0-7-7Z"></path>
                                        <path d="M9 21h6"></path>
                                        <path d="M9 17h6"></path>
                                    </g>
                                </svg>
                            </button>
                            <span class="separator">\\</span>
                            <a href="/" class="breadcrumb" title="Home Directory">BodgeLab</a>
                            
                            
                            
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <a href="/.config/" class="breadcrumb">.config</a>
                                    
                                
                            
                                
                                    
                                    <span class="separator">\</span>
                                    
                                        <a href="/.config/favicon editor/" class="breadcrumb">favicon editor</a>
                                    
                                
                            
                                
                            
                        </div>
                    </div>
                    <div
                        class="page-nav">
                        
                        
                            <div>
                                <a href="/.config/" class="nav-link up">â‡± Go Up</a>
                            </div>
                        
                        
                        
                            <div class="page-meta-date">
                                <i>
                                    <em>Modified: December 09, 2025</em>
                                </i>
                            </div>
                        
                    </div>
                </nav>
            </header>
            
                <main class="main-content">
                    
                        <h2>Edit Your Favicon</h2>
<p>Click pixels to paint. Right-click to erase.</p>
<div class="editor-ui">
<p><div class="editor-controls"><br>
<div class="control-group"><br>
<label>Color</label><br>
<input type="color" id="paint-color"><br>
</div></p>
<p><div class="control-group"><br>
<label>Opacity</label><br>
<input type="range" id="paint-opacity" min="0.1" max="1.0" step="0.1" value="1.0"><br>
</div></p>
<p><div class="control-group"><br>
<label>Actions</label><br>
<button id="btn-random" class="editor-btn">REROLL</button><br>
<button id="btn-clear" class="editor-btn">CLEAR</button><br>
</div><br>
</div></p>
<p><div id="pixel-grid" class="pixel-grid"></div></p>
<p><p style="text-align:center; font-size:0.8em; color:var(--text-muted); margin-top:1em;"><br>
Changes save automatically. Check your tab bar!<br>
</p></p>
</div>
<style>
/* Editor Styles */
.editor-ui {
    background: var(--bg-muted);
    padding: 2em;
    border: 1px solid var(--border-color);
    max-width: 500px;
    margin: 0 auto;
}

.editor-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5em;
    margin-bottom: 2em;
    justify-content: center;
    border-bottom: 1px dashed var(--border-color);
    padding-bottom: 1em;
}

.control-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5em;
}


.pixel-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    
    /* FIX: Force rows to fill the height */
    grid-template-rows: repeat(5, 1fr); 
    
    gap: 2px;
    width: 250px;
    height: 250px;
    margin: 0 auto;
    background-color: var(--border-color);
    border: 2px solid var(--text-color);
}

.pixel {
    background-color: var(--bg-color);
    cursor: pointer;
    transition: transform 0.1s;
}
.pixel:hover { transform: scale(0.9); }

.editor-btn {
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    padding: 5px 10px;
    cursor: pointer;
    font-family: var(--mono-font);
    font-size: 0.8em;
}
.editor-btn:hover, .editor-btn.active {
    background: var(--accent-color);
    color: white;
}
</style>
<script>

function hslToHex(h, s, l) {
  l /= 100;
  const a = s * Math.min(l, 1 - l) / 100;
  const f = n => {
    const k = (n + h / 30) % 12;
    const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
    return Math.round(255 * color).toString(16).padStart(2, '0');
  };
  return `#${f(0)}${f(8)}${f(4)}`;
}

document.addEventListener('DOMContentLoaded', () => {
    const gridEl = document.getElementById('pixel-grid');
    const colorInput = document.getElementById('paint-color');
    const alphaInput = document.getElementById('paint-opacity');
    
    // Global State
    let identity = window.BodgeIdentity ? window.BodgeIdentity.data : { hue: 0, grid: [] };
    let useThemeColor = true;
    const startHex = hslToHex(identity.hue, 70, 50);
    colorInput.value = startHex;

    // --- RENDER GRID ---
    function renderGrid() {
        gridEl.innerHTML = '';
        
        // Base Theme Colors for preview
        const cPreview = `hsl(${identity.hue}, 70%, 50%)`;

        for(let i=0; i<25; i++) {
            const px = identity.grid[i];
            const div = document.createElement('div');
            div.className = 'pixel';
            div.dataset.index = i;
            
            if (px) {
                // If custom color, use it. Else use theme preview.
                div.style.backgroundColor = px.c || cPreview;
                div.style.opacity = px.o;
            } else {
                div.style.backgroundColor = 'transparent';
            }

            // Events
            div.onmousedown = (e) => handlePaint(i, e);
            div.onmouseenter = (e) => { if(e.buttons === 1) handlePaint(i, e); };
            // Right click to erase
            div.oncontextmenu = (e) => { e.preventDefault(); handlePaint(i, e, true); };

            gridEl.appendChild(div);
        }
    }

    // --- PAINT LOGIC ---
    function handlePaint(index, e, forceErase = false) {
        if (forceErase || e.button === 2) {
            // Eraser
            identity.grid[index] = null;
        } else {
            // Brush
            const opacity = alphaInput.value;
            const pixelData = { o: opacity };
            
            if (!useThemeColor) {
                pixelData.c = colorInput.value;
            }
            // If theme color, we just omit 'c' property
            
            identity.grid[index] = pixelData;
        }
        
        // Update UI
        renderGrid();
        // Update Real Favicon
        updateFavicon();
        // Save
        window.BodgeIdentity.save(identity);
    }

    // --- UPDATE REAL FAVICON ---
    function updateFavicon() {
        // We essentially re-run the logic from layout.njk
        
        const cLight = `hsl(${identity.hue}, 80%, 40%)`;
        const cDark  = `hsl(${identity.hue}, 80%, 70%)`;
        
        let rects = '';
        identity.grid.forEach((pixel, i) => {
            if (!pixel) return;
            const x = i % 5;
            const y = Math.floor(i / 5);
            // inline styles for the editor update to ensure immediate feedback
            // (Media queries inside data-uri SVGs can be tricky on some updates, but we try)
            const fillAttr = pixel.c ? `fill="${pixel.c}"` : `class="themable"`;
            rects += `<rect x="${x}" y="${y}" width="1" height="1" opacity="${pixel.o}" ${fillAttr} />`;
        });

        const svg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 5 5" shape-rendering="crispEdges">
            <style>
                .themable { fill: ${cLight}; }
                @media (prefers-color-scheme: dark) { .themable { fill: ${cDark}; } }
                text { fill: black; font-weight: 900; pointer-events: none; }
                @media (prefers-color-scheme: dark) { text { fill: white; } }
            <\/style>
            ${rects}
            <text x="2.5" y="3.5" text-anchor="middle" font-family="monospace" font-size="3px"></text>
        </svg>`;

        const link = document.getElementById('dynamic-favicon');
        if(link) link.href = 'data:image/svg+xml,' + encodeURIComponent(svg);
    }

    // --- CONTROLS ---

    colorInput.oninput = () => {
        useThemeColor = false;
        btnTheme.classList.remove('active');
        colorInput.parentElement.style.opacity = '1';
    };

    document.getElementById('btn-clear').onclick = () => {
        identity.grid = new Array(25).fill(null);
        renderGrid();
        updateFavicon();
        window.BodgeIdentity.save(identity);
    };

    document.getElementById('btn-random').onclick = () => {
        // Nuke local storage key and reload to trigger the layout.njk genesis script
        localStorage.removeItem('bodge-id-v1');
        window.location.reload();
    };

    // Init
    renderGrid();
});
</script>

                    
                    
                    
                    
                    <div id="dir-sentinel" style="display: block; width: 100%; visibility: hidden; pointer-events: none;"></div>
                </main>
            
            
            
                <script>/*
                // REPLACE URL IN BAR WITH SHARELINK
                (function () { // 1. This is the "permanent" URL
                    const permanentUrl = "/s/favicon-editor/";
                    // 2. This is the URL we are currently at
                    const currentPath = window.location.pathname;
                    // 3. If we're not already on the permanent URL...
                    if (currentPath !== permanentUrl) {
                        // ...replace the history state. This changes the URL in the bar without reloading the page or breaking the back
                        // button.
                        history.replaceState(null, "", permanentUrl);
                    }
                })();
                // */</script>
        
        <script src="/js/main.js"></script>
    </body>
</body></html>